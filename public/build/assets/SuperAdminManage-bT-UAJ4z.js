import{j as e,r as a,y,W as B,Y as W}from"./app-CQ1v4CXz.js";import{S as $}from"./SuperAdminLayout-lKPSrpE7.js";import{I as T}from"./IconInvite-DrE39Oi-.js";import{I as Q}from"./IconCheckBox-BxMpXa6u.js";import{M as R}from"./MainAdminFrame-HGgth6Yz.js";import{I as _}from"./IconEdit-B1gwtGkY.js";import{S as q,A as w}from"./Searchbar-lraFH9y0.js";import{I as U}from"./IconEye-BYZqzFHM.js";import{D as Y,a as G,b as J,c as K,d as X,g as Z}from"./dropdown-menu-Cc23jRhD.js";import{D as z,b as ee,c as te,d as se,e as le}from"./dialog-DnTO6yaC.js";import"./alert-dialog-3BVQ5u_O.js";import{H as re}from"./Home-DQEkPH3z.js";import{I as ae}from"./OrganizationLayout-UbVSozwH.js";import"./switch-BaMCBZ6d.js";import{C as ne}from"./CustomPagination-afwY0C4i.js";import{S as ie,a as oe,b as ce,c as de,d as S}from"./select-31HJZ_vV.js";import"./IconMenu3-C4gMQUm3.js";import"./createLucideIcon-_flAZbB2.js";import"./PrivacyPolicy-DXgBuK9f.js";import"./Logo-Cz12jA4C.js";import"./utils-aYM5bCtc.js";import"./index-DEyZLPC0.js";import"./index-B8eaYLFf.js";import"./index-CoQsayVf.js";import"./button-DYTK1q6P.js";import"./IconSearch-pLzPSCME.js";import"./index-CXnUhIzJ.js";import"./index-Xx_peI74.js";import"./index-BEgwai2j.js";import"./check-VgFVxUij.js";import"./index-fG1OfbE1.js";import"./IconMailFilled-ANlHdb86.js";import"./UserLayout-CtkuBJr0.js";import"./IconProfile-oU0p8ZUI.js";import"./index-Dg5ngjjh.js";import"./index-DiipibtH.js";function me({size:t}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t||"24",height:t||"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon icon-tabler icons-tabler-outline icon-tabler-users",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"}),e.jsx("path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),e.jsx("path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85"})]})}function pe({size:t}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t||"24",height:t||"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon icon-tabler icons-tabler-outline icon-tabler-bolt",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11"})]})}function xe({size:t,className:i}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t||"24",height:t||"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`icon icon-tabler icons-tabler-outline icon-tabler-chevron-down ${i}`,children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M6 9l6 6l6 -6"})]})}function he({size:t}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t||"24",height:t||"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon icon-tabler icons-tabler-outline icon-tabler-device-floppy",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"}),e.jsx("path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),e.jsx("path",{d:"M14 4l0 4l-6 0l0 -4"})]})}function ue({size:t}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t||"24",height:t||"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon icon-tabler icons-tabler-outline icon-tabler-cancel",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),e.jsx("path",{d:"M18.364 5.636l-12.728 12.728"})]})}function fe({onSelect:t,...i}){return e.jsxs(Y,{children:[e.jsx(G,{className:"w-full",children:i.triggerContent}),e.jsxs(J,{className:"bg-[#f8f8f8] border-gray-300 flex flex-col justify-center space-y-2 p-2",children:[e.jsx(K,{className:"poppins",children:i.title}),e.jsx(X,{className:"bg-gray-300 mx-2"}),i.dropdownItems.map((m,n)=>e.jsx(Z,{onSelect:()=>t(m.value),className:"poppins",children:m.name},n))]})]})}function je({edit:t,visible:i,setVisible:m,organization:n,onEdit:D,onDelete:c}){a.useRef(null);const h=i?"bg-green-50  border-green-600 text-green-800":"bg-red-50  border-red-600 text-red-800";a.useState({name:n.name,department:n.department});const[d,j]=a.useState(!1),[p,u]=a.useState(null);return a.useEffect(()=>{(async()=>{if(!d)u(null);else try{const x=await axios.get(route("superadmin.fetchOrgData",n.orgID));u(x.data)}catch{u(!1)}})()},[d]),e.jsxs("div",{className:"hover:scale-[1.02] transition-all duration-300 ease-in-out px-4 rounded-xl divide-y divide-gray-300 shadow-lg bg-white hover:bg-gray-100 transOptimize",children:[e.jsxs("div",{className:"py-4 ",children:[e.jsxs("div",{className:"grid grid-cols-6  ",children:[e.jsx("div",{className:"p-2 col-span-2 content-center",children:e.jsx("img",{className:"rounded-full",src:`/storage/logo/${n.logo}`,alt:"Organization Logo",onError:o=>{o.target.onerror=null,o.target.src="https://placehold.co/500x500"}})}),e.jsx("div",{className:"col-span-3  px-2",children:e.jsx("h1",{className:"text-sm font-bold py-4 ",children:n.name})})]}),e.jsx("h3",{className:"text-gray-500 text-xs pt-4 text-justify font-semibold",children:n.department})]}),e.jsxs("div",{className:"grid grid-rows-1 py-4",children:[e.jsxs("div",{className:"grid grid-cols-6 py-1",children:[e.jsx("div",{className:"col-start-1 col-end-2 flex justify-center",children:e.jsx(me,{})}),e.jsx("div",{className:"text-sm font-semibold col-start-2 col-end-4 content-center",children:"Members:"}),e.jsx("div",{className:"text-sm font-semibold col-start-4 col-end-7 flex justify-center",children:n.members_count!==void 0?n.members_count:"Members not set"})]}),e.jsxs("div",{className:"grid grid-cols-6 py-1 ",children:[e.jsx("div",{className:"col-start-1 col-end-2 flex justify-center ",children:e.jsx(U,{})}),e.jsx("div",{className:"text-sm font-semibold col-start-2 col-end-4 content-center",children:e.jsx("span",{children:"Visibility:"})}),t?e.jsx("div",{className:`text-sm font-semibold col-start-4 col-end-7 flex justify-center rounded-xl border-2 ${h}`,children:e.jsx(fe,{triggerContent:e.jsxs("div",{className:"pl-1 flex items-center justify-center poppins",children:[i?"Visible":"Not Visible",e.jsx(xe,{size:"15"})]}),title:"Select visibility",dropdownItems:[{name:"Visible",value:!0},{name:"Not Visible",value:!1}],onSelect:m})}):e.jsx("div",{className:`text-sm font-semibold col-start-4 col-end-7 flex justify-center rounded-xl border-2 ${h}`,children:e.jsx("div",{className:"pl-1 flex content-center poppins",children:i?"Visible":"Not Visible"})})]}),e.jsxs("div",{className:"grid grid-cols-6 py-1 ",children:[e.jsx("div",{className:"col-start-1 col-end-2 flex justify-center",children:e.jsx(pe,{})}),e.jsx("div",{className:"text-sm font-semibold col-start-2 col-end-4 content-center",children:"Status:"}),e.jsx("div",{className:`text-sm font-semibold col-start-4 col-end-7 flex justify-center rounded-xl poppins border-2 ${h}`,children:i?"Active":"Inactive"})]}),e.jsx("div",{className:`pb-1 pt-3 w-full flex items-center ${t&&"opacity-50 pointer-events-none"}`,children:e.jsx("button",{className:"border-2 border-slate-600 bg-slate-200 hover:bg-slate-300 text-sm font-semibold w-full rounded-full py-1",onClick:()=>j(o=>!o),children:"Preview"})})]}),e.jsx(f,{})]});function f(){return e.jsx(z,{open:d,onOpenChange:o=>{u(null),j(o)},children:e.jsxs(ee,{className:"max-h-[90%] md:max-w-[90%] max-w-full overflow-y-auto px-0",children:[e.jsxs(te,{className:"px-4",children:[e.jsxs(se,{children:['Previewing "',n.name,'" Home page:']}),e.jsx(le,{})]}),p===null?e.jsx("div",{className:"w-full h-52 flex items-center justify-center",children:e.jsx("div",{className:"w-[40px] flex justify-center",children:e.jsx("div",{className:"dot-flashing"})})}):p===!1?e.jsxs("span",{className:"font-bold text-red-500 flex gap-3",children:[e.jsx(ae,{})," Failed to fetch preview data."]}):e.jsx("div",{className:"pointer-events-none w-full overflow-y-auto bg-[#EEEEEE] pb-10",children:e.jsx(re,{pageData:p.pageData,pageLayoutData:p.pageLayoutData,withFollow:p.withFollow,preview:!0})})]})})}}function st({organizations:t={data:[]},departments:i=[],filters:m={}}){const[n,D]=a.useState((t==null?void 0:t.data)||[]),[c,h]=a.useState(m.search||""),[d,j]=a.useState(m.department||"All"),[p,u]=a.useState(i),[f,o]=a.useState(!1),[x,b]=a.useState(()=>{const s={};return t!=null&&t.data&&t.data.forEach(l=>{s[l.orgID]=l.visibility}),s}),[k,v]=a.useState({}),[ve,C]=a.useState((t==null?void 0:t.data)||[]),I=s=>{h(s.target.value)},E=s=>{j(s),y.get(route("superadmin.status"),{search:c,department:s},{preserveState:!0,preserveScroll:!0})};a.useEffect(()=>{t!=null&&t.data&&b(s=>{const l={...s};return t.data.forEach(r=>{k[r.orgID]||(l[r.orgID]=r.visibility)}),l})},[t==null?void 0:t.data]),a.useEffect(()=>{const s=setTimeout(()=>{y.get(route("superadmin.status"),{search:c,department:d},{preserveState:!0,preserveScroll:!0})},300);return()=>clearTimeout(s)},[c]),a.useEffect(()=>{(()=>{let l=n;c&&(l=l.filter(r=>{var g,N;return((g=r==null?void 0:r.name)==null?void 0:g.toLowerCase().includes(c.toLowerCase()))||((N=r==null?void 0:r.department)==null?void 0:N.toLowerCase().includes(c.toLowerCase()))})),d!=="All"&&(l=l.filter(r=>(r==null?void 0:r.department)===d)),C(l)})()},[c,d,n]);const{data:be,setData:M,post:L,processing:A,reset:O}=B({organizations:[]});a.useEffect(()=>{M("organizations",Object.entries(x).map(([s,l])=>({id:s,visibility:l})))},[x]);const V=()=>{o(s=>!s),f||v({})},H=(s,l)=>{b(r=>({...r,[s]:l})),v(r=>({...r,[s]:!0}))},P=()=>{L(route("superadmin.update-organizations"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{o(!1),v({})},onError:()=>{console.error("Save failed. Please try again.")}})},F=()=>{if(t!=null&&t.data){const s={};t.data.forEach(l=>{s[l.orgID]=l.visibility}),b(s),v({})}o(!1),O()};return e.jsxs("div",{className:"w-full",children:[e.jsx(W,{title:"OSA Dashboard"}),e.jsx($,{children:e.jsx(R,{navItems:[{icon:e.jsx(Q,{}),label:"Status",link:"superadmin.status"},{icon:e.jsx(T,{}),label:"Invite",link:"superadmin.invite"}],title:"Manage Organizations",searchbar:e.jsx(q,{className:"col-span-3",value:c,onChange:I,placeholder:"Search for an organization"}),filter:e.jsx("div",{className:"text-xs col-span-2 shadow-lg flex justify-center rounded-r-xl bg-white text-black",children:e.jsxs(ie,{value:d,onValueChange:E,children:[e.jsx(oe,{className:"w-full h-12 border-white bg-transparent",children:e.jsx(ce,{placeholder:"All"})}),e.jsxs(de,{className:"border-gray-500 bg-[#EEEEEE] quicksand",children:[e.jsx(S,{value:"All",children:"All"}),p.map((s,l)=>e.jsx(S,{value:s,children:s},l))]})]})}),children:e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex justify-end me-5 mt-5",children:f?e.jsxs("div",{className:"flex",children:[e.jsx(w,{className:"py-2 mr-2 bg-green-100 hover:text-white hover:bg-green-800",onClick:P,icon:e.jsx(he,{}),name:"Save",disabled:A}),e.jsx(w,{className:"py-2 mr-2 bg-red-100 hover:text-white hover:bg-red-800",onClick:F,icon:e.jsx(ue,{}),name:"Cancel"})]}):e.jsx(w,{className:"py-2 bg-white hover:bg-gray-800 hover:text-white",onClick:V,icon:e.jsx(_,{}),name:"Edit"})}),!(t!=null&&t.data)||t.data.length===0?e.jsx("div",{className:"m-14 sm:m-48 text-xl font-thin text-center",children:"No Organizations Found"}):e.jsx("div",{className:"grid lg:grid-cols-4 sm:grid-cols-2 grid-cols-1 gap-4 p-5 pb-20",children:t.data.map(s=>e.jsx(je,{edit:f,visible:x[s.orgID],setVisible:l=>H(s.orgID,l),organization:s},s.orgID))}),e.jsx("div",{className:"fixed w-screen bottom-0 left-0 right-0 pl-8 sm:pl-24 pr-10 pb-3 flex justify-center",children:e.jsx(ne,{page:t})})]})})})]})}export{st as default};
