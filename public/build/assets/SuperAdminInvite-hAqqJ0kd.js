import{j as e,r as i,W as M,Y as V,b as q,y as A}from"./app-Nah0YeiV.js";import{M as B}from"./MainAdminFrame-D0SRY3mz.js";import{S as X}from"./SuperAdminLayout-C8Y66xxk.js";import{I as g}from"./IconInvite-kXN3mUA3.js";import{I as _}from"./IconCheckBox-BJDFvKZh.js";import{V as O}from"./VerticalCard-BRr0Ev3n.js";import{D as J}from"./DotsVertical-DRnkfoIw.js";import{S as C,A as P}from"./Searchbar-XZwVpj3n.js";import{A as v}from"./AdminDialog-BM415EYD.js";import{A as T}from"./AdminInvDropdownMenu-Bj9UiKBJ.js";import{A as W}from"./AdminAlertDialog-Ddl9iSud.js";import"./dropdown-menu-D5ewfSrD.js";import"./dialog-q4YAmxIc.js";import{m as Y}from"./IconMenu3-Be-ovQ-L.js";import"./button-NIdFJHNh.js";import"./IconSearch-D5onNVrH.js";/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=Y("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function k({organization:s,onClick:n,selectedOrg:c,userRoles:h,onDelete:x,isDeleting:u}){const l=h.some(o=>o.roleID===2&&o.orgID===s.orgID);return e.jsxs("div",{onClick:()=>{l||n()},className:`hover:scale-[1.02] cursor-pointer transition-all duration-300 ease-in-out px-4 rounded-xl divide-y divide-gray-300 shadow-lg  ${c===s.orgID?"ring ring-gray-300 ring-offset-4 bg-gray-200":"bg-white"} 
            ${l?"bg-gray-200":"hover:bg-gray-100"} 
            transOptimize relative`,children:[e.jsx("div",{className:"py-4 ",children:e.jsxs("div",{className:"grid grid-cols-3 divide-x divide-gray-300",children:[e.jsx("div",{className:"p-2 content-center",children:e.jsx("img",{className:"rounded-full",src:s.logo,alt:s.name})}),e.jsxs("div",{className:"col-span-2  px-2",children:[e.jsx("h1",{className:"text-sm font-bold py-2 ",children:s.name}),e.jsx("h3",{className:"text-gray-500 text-xs  text-justify font-semibold",children:s.department}),l&&e.jsx("span",{className:"text-xs font-semibold text-green-500",children:"Admin of this Org"})]})]})}),l&&u&&e.jsx("button",{onClick:o=>{o.stopPropagation(),x(s.orgID)},className:"absolute top-2 right-2 text-red-500 hover:text-red-700",children:e.jsx(G,{size:20})})]})}function w({...s}){return e.jsx(v,{title:s.title,description:s.description,trigger:s.trigger,children:e.jsxs("form",{onSubmit:s.handleInvite,children:[e.jsx(C,{className:"col-span-3",value:s.orgSearchQuery,onChange:s.handleOrgSearchChange,placeholder:"Search for an organization"}),e.jsx("div",{className:"max-h-[400px] overflow-auto",children:s.filteredOrganizations.length!==0?e.jsx("div",{className:"grid sm:grid-cols-2 overflow-auto grid-cols-1 gap-4 p-5",children:s.filteredOrganizations.map(n=>e.jsx(k,{userRoles:s.currentUserRoles,organization:n,onClick:()=>{s.getOrg(n.orgID)},selectedOrg:s.selectedOrg,onDelete:s.onDelete},n.orgID))}):e.jsx("div",{className:"m-14 sm:m-48 text-xl font-thin text-center",children:"No Organization Found"})}),e.jsx("div",{className:"grid justify-items-end",children:e.jsx(P,{className:"mr-2 mt-5  bg-white hover:bg-green-800 hover:text-white",icon:e.jsx(g,{}),name:"Save",type:"submit",disabled:s.processing})})]})})}function pe({users:s,organizations:n,userRoles:c}){const[h,x]=i.useState(""),[u,l]=i.useState([]),[o,H]=i.useState(n),[b,R]=i.useState(n),[d,K]=i.useState(""),[I,z]=i.useState([]),[f,U]=i.useState(0),[m,L]=i.useState(null),p=c.filter(t=>t.userID===m),{data:Z,setData:N,post:$,processing:D,errors:ee}=M({userID:"",orgID:"",roleID:2}),E=async t=>{const r=t.target.value;if(x(r),r.length>0)try{const a=await q.get("/superadmin/search-users",{params:{query:r}});l(a.data)}catch(a){console.error("Error fetching result:",a)}else l([])},F=t=>{A.delete(route("superadmin.delete-admin-role",{userID:m,orgID:t}),{preserveState:!0,preserveScroll:!0})};i.useEffect(()=>{if(m){const t=n.filter(r=>c.some(a=>a.userID===m&&a.orgID===r.orgID));z(t)}},[m,n,c]),i.useEffect(()=>{(()=>{let r=o;d&&(r=r.filter(a=>a.name.toLowerCase().includes(d.toLowerCase())||a.department.toLowerCase().includes(d.toLowerCase()))),R(r)})()},[d,o]);const j=t=>{N("userID",t),L(t)},y=t=>{N("orgID",t),U(t)},S=t=>{t.preventDefault(),$(route("superadmin.add-admin"))},Q=t=>{A.delete(route("superadmin.delete-admin",t),{preserveState:!0,preserveScroll:!0})};return e.jsxs("div",{className:"w-full",children:[e.jsx(V,{title:"OSA Dashboard"}),e.jsx(X,{children:e.jsx(B,{navItems:[{icon:e.jsx(_,{}),label:"Status",link:"superadmin.status"},{icon:e.jsx(g,{}),label:"Invite",link:"superadmin.invite"}],title:"Role Invitation",children:e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-end me-5 mt-5",children:e.jsxs(v,{title:"Assign Role for Student",description:`Search for a student and assign them to be the
                        administrator of their organization.`,trigger:e.jsxs("div",{role:"button",className:"mr-2 bg-white flex px-9  shadow-lg rounded-2xl hover:bg-gray-800 hover:text-white",name:"Assign",children:[e.jsx(g,{}),e.jsx("span",{className:"ml-2 poppins hidden truncate sm:block",children:"Invite"})]}),children:[e.jsx(C,{value:h,onChange:E,placeholder:"Search by name or email"}),e.jsx("div",{children:u.map(t=>e.jsxs(O,{gridcol:"grid-cols-4",children:[e.jsxs("div",{className:"text-sm font-bold content-center text-center",children:[t.firstname," ",t.lastname]}),e.jsx("div",{className:"truncate col-span-2 content-center text-sm font-semibold text-center",children:t.email}),e.jsx("div",{className:"sm px-4 text-sm content-center ",children:e.jsx(w,{title:"Assign Role for Student",description:e.jsxs("div",{children:["Asssign"," ",e.jsxs("span",{className:"font-bold",children:[t.firstname," ",t.lastname," "]}),"to what organization?"]}),trigger:e.jsxs("div",{role:"button",className:"mr-2 bg-white flex px-9  shadow-lg rounded-2xl hover:bg-gray-800 hover:text-white",name:"Assign",onClick:()=>{j(t.userID)},children:[e.jsx(g,{}),e.jsx("span",{className:"ml-2 poppins hidden truncate sm:block",children:"Assign"})]}),handleInvite:S,filteredOrganizations:b,currentUserRoles:p,selectedOrg:f,processing:D,getOrg:y})})]},t.userID))})]})}),e.jsx("div",{className:"grid grid-rows-1 p-5 gap-2",children:s.map(t=>e.jsxs(O,{gridcol:"md:grid-cols-12",children:[e.jsx("div",{className:" col-span-3 content-center",children:e.jsxs("h1",{className:"md:ml-2 text-center md:text-left font-bold",children:[t.firstname," ",t.lastname]})}),e.jsx("div",{className:"col-span-3 content-center",children:e.jsx("h1",{className:"text-center font-semibold truncate text-gray-500",children:t.email})}),e.jsx("div",{className:"col-span-3 content-center",children:e.jsx("h1",{className:" text-center text-sm font-semibold text-gray-500",children:t.college})}),e.jsx("div",{className:"col-span-2 px-4 text-sm flex items-center justify-center ",children:e.jsx(v,{trigger:e.jsxs("h1",{onClick:()=>{j(t.userID)},className:"px-4 text-center font-semibold rounded-xl poppins bg-green-50 border-2 border-green-600 text-green-800",children:["Joined"," ",t.organizations_count," ",t.organizations_count>1?"Organizations":"Organization"]}),title:`Assigned Organizations for ${t.firstname} ${t.lastname}`,children:I.length!==0?e.jsx("div",{className:"grid sm:grid-cols-2 overflow-auto grid-cols-1 gap-4 p-5",children:I.map(r=>e.jsx(k,{isDeleting:!0,userRoles:p,organization:r,onClick:()=>{},selectedOrg:f,onDelete:F},r.orgID))}):e.jsx("div",{className:"m-14 sm:m-48 text-xl font-thin text-center",children:"No Organization Found"})})}),e.jsx(T,{triggerContent:e.jsx(J,{}),title:"Select Action",dropdownItems:[{name:e.jsx(w,{title:"Assign Role for Student",description:e.jsxs("div",{children:["Asssign"," ",e.jsxs("span",{className:"font-bold",children:[t.firstname," ",t.lastname," "]}),"to what organization?"]}),trigger:e.jsx("div",{onClick:()=>{j(t.userID)},children:"Assign Another Role"}),handleInvite:S,orgSearchQuery:d,filteredOrganizations:b,currentUserRoles:p,selectedOrg:f,processing:D,getOrg:y})},{name:e.jsx(W,{trigger:"Delete All Roles",title:`Remove ${t.firstname} ${t.lastname} as admin?`,description:"This will remove all the admin roles of this user to his/her assigned organization.",accept:"Confirm",onclick:()=>{Q(t.userID)}})}]})]}))})]})})})]})}export{pe as default};
