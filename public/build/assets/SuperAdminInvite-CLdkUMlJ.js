import{j as e,r as a,W as K,Y as Z,d as ee,y as F}from"./app-BKBnLzJI.js";import{M as te}from"./MainAdminFrame-p-qqMlGP.js";import{S as se}from"./SuperAdminLayout-BsM8oOw6.js";import{I as j}from"./IconInvite-BDNTsvZ_.js";import{I as re}from"./IconCheckBox-BfuRYyT9.js";import{V as L}from"./VerticalCard-wPg__ozH.js";import{S as D,A as ne}from"./Searchbar-Q3f7yWhy.js";import{A as C}from"./AdminDialog-Dq2qKLyy.js";import"./dropdown-menu-lnoiwiIH.js";import"./alert-dialog-DmF-QlDH.js";import{e as ae}from"./dialog-Bc-sKvZF.js";import{c as ie}from"./createLucideIcon-C34Sa7zH.js";import{C as oe}from"./CustomPagination-DEFXzyPv.js";import"./utils-Dl6xOOy_.js";import"./button-DcR-txGL.js";import"./index-DtQRwoet.js";import"./IconMenu3-CHtmeEEN.js";import"./Logo-Ct1JH_jw.js";import"./index-BQT-W7Yv.js";import"./IconSearch-DrKZCVAI.js";import"./index-BPqJW4xh.js";import"./index-dDKGkq02.js";import"./index-CWFXyQlM.js";import"./index-C3PG-aQC.js";/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=ie("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function E({organization:r,onClick:l,selectedOrg:m,userRoles:h,onDelete:x,isDeleting:g}){const o=h.some(i=>i.roleID===2&&i.orgID===r.orgID);return e.jsxs("div",{onClick:()=>{o||l()},className:`hover:scale-[1.02] cursor-pointer transition-all duration-300 ease-in-out px-4 rounded-xl divide-y divide-gray-300 shadow-lg  ${m===r.orgID?"ring ring-gray-300 ring-offset-4 bg-gray-200":"bg-white"} 
            ${o?"bg-gray-200":"hover:bg-gray-100"} 
            transOptimize relative`,children:[e.jsx("div",{className:"py-4 ",children:e.jsxs("div",{className:"grid grid-cols-3 divide-x divide-gray-300",children:[e.jsx("div",{className:"p-2 content-center",children:e.jsx("img",{className:"rounded-full",src:`/storage/logo/${r.logo}`,alt:"Organization Logo",onError:i=>{i.target.onerror=null,i.target.src="https://placehold.co/500x500"}})}),e.jsxs("div",{className:"col-span-2  px-2",children:[e.jsx("h1",{className:"text-sm font-bold py-2 ",children:r.name}),e.jsx("h3",{className:"text-gray-500 text-xs  text-justify font-semibold",children:r.department}),o&&e.jsx("span",{className:"text-xs font-semibold text-green-500",children:"Admin of this Org"})]})]})}),o&&g&&e.jsx("button",{onClick:i=>{i.stopPropagation(),x(r.orgID)},className:"absolute top-2 right-2 text-red-500 hover:text-red-700",children:e.jsx(le,{size:20})})]})}function R({title:r,description:l,trigger:m,handleInvite:h,orgSearchQuery:x,handleOrgSearchChange:g,filteredOrganizations:o,currentUserRoles:i,getOrg:A,selectedOrg:p,onDelete:y,processing:c}){const u=p!==0,v=d=>{d.preventDefault(),u&&h(d)};return e.jsx(C,{title:r,trigger:m,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(ae,{asChild:!0,children:e.jsx("div",{className:"text-base",children:l})}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsx(D,{className:"col-span-3",value:x,onChange:g,placeholder:"Search for an organization"}),e.jsx("div",{className:"max-h-[400px] overflow-auto",children:o.length>0?e.jsx("div",{className:"grid sm:grid-cols-2 grid-cols-1 gap-4 p-5",children:o.map(d=>e.jsx(E,{userRoles:i,organization:d,onClick:()=>A(d.orgID),selectedOrg:p,onDelete:y},d.orgID))}):e.jsx("div",{className:"m-14 sm:m-48 text-xl font-thin text-center",children:"No Organization Found"})}),e.jsx("div",{className:"flex justify-end space-x-2",children:e.jsx(ne,{className:`bg-white ${u?"hover:bg-green-800 hover:text-white":"opacity-50 cursor-not-allowed"}`,icon:e.jsx(j,{}),name:"Save",type:"submit",disabled:!u||c})})]})]})})}function Re({users:r,organizations:l,userRoles:m}){const[h,x]=a.useState(""),[g,o]=a.useState([]),[i,A]=a.useState(l),[p,y]=a.useState(l),[c,u]=a.useState(""),[v,d]=a.useState([]),[N,Q]=a.useState(0),[f,M]=a.useState(null),S=m.filter(t=>t.userID===f),{data:T,setData:w,post:V,processing:O,errors:ce}=K({userID:"",orgID:"",roleID:2}),[b,q]=a.useState(""),B=X(t=>{F.get(route("superadmin.invite"),{search:t},{preserveState:!0,preserveScroll:!0,replace:!0})},300),P=t=>{const s=t.target.value;q(s),B(s)};function X(t,s){let n;return function(...Y){const G=()=>{clearTimeout(n),t(...Y)};clearTimeout(n),n=setTimeout(G,s)}}const _=async t=>{const s=t.target.value;if(x(s),s.length>0)try{const n=await ee.get("/superadmin/search-users",{params:{query:s}});o(n.data)}catch(n){console.error("Error fetching result:",n)}else o([])},H=t=>{F.delete(route("superadmin.delete-admin-role",{userID:f,orgID:t}),{preserveState:!0,preserveScroll:!0})};a.useEffect(()=>{if(f){const t=l.filter(s=>m.some(n=>n.userID===f&&n.orgID===s.orgID));d(t)}},[f,l,m]),a.useEffect(()=>{(()=>{let s=i;c&&(s=s.filter(n=>n.name.toLowerCase().includes(c.toLowerCase())||n.department.toLowerCase().includes(c.toLowerCase()))),y(s)})()},[c,i]);const k=t=>{u(t.target.value)},I=t=>{w("userID",t),M(t)},z=t=>{w("orgID",t),Q(t)},U=t=>{t.preventDefault(),V(`/superadmin/addadmin/${N}/${T.userID}`)},[$,de]=a.useState(r),[me,J]=a.useState((r==null?void 0:r.data)||[]);return a.useEffect(()=>{(()=>{let s=$.data;b&&(s=s.filter(n=>`${n.firstname} ${n.lastname}`.toLowerCase().includes(b.toLowerCase()))),J(s)})()},[b,$]),e.jsxs("div",{className:"w-full",children:[e.jsx(Z,{title:"OSA Dashboard"}),e.jsx(se,{children:e.jsx(te,{navItems:[{icon:e.jsx(re,{}),label:"Status",link:"superadmin.status"},{icon:e.jsx(j,{}),label:"Invite",link:"superadmin.invite"}],title:"Role Invitation",searchbar:e.jsx(D,{className:"col-span-3",value:b,onChange:P,placeholder:"Search for a user",onInviteAdmin:!0}),onInviteAdmin:!0,children:e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-end me-5 mt-5",children:e.jsxs(C,{title:"Assign Role for Student",description:`Search for a student and assign them to be the
                        administrator of their organization.`,trigger:e.jsxs("div",{role:"button",className:"mr-2 py-2 bg-white flex px-9  shadow-lg rounded-2xl hover:bg-gray-800 hover:text-white",name:"Assign",children:[e.jsx(j,{}),e.jsx("span",{className:"ml-2 poppins hidden truncate sm:block",children:"Invite"})]}),children:[e.jsx(D,{value:h,onChange:_,placeholder:"Search by name or email"}),e.jsx("div",{children:g.map(t=>e.jsxs(L,{gridcol:"grid-col-1 md:grid-cols-4",children:[e.jsxs("div",{className:"text-sm font-bold content-center text-center",children:[t.firstname," ",t.lastname]}),e.jsx("div",{className:"truncate col-span-2 content-center text-sm font-semibold text-center",children:t.email}),e.jsx("div",{className:"sm px-4 text-sm flex items-center justify-center ",children:e.jsx(R,{title:"Assign Role for Student",description:e.jsxs("div",{children:["Asssign"," ",e.jsxs("span",{className:"font-bold",children:[t.firstname," ",t.lastname," "]}),"to what organization?"]}),trigger:e.jsxs("div",{role:"button",className:"mr-2 bg-white flex px-9  shadow-lg rounded-2xl hover:bg-gray-800 hover:text-white",name:"Assign",onClick:()=>{I(t.userID)},children:[e.jsx(j,{}),e.jsx("span",{className:"ml-2 poppins hidden truncate sm:block",children:"Assign"})]}),handleInvite:U,filteredOrganizations:p,currentUserRoles:S,selectedOrg:N,processing:O,getOrg:z,orgSearchQuery:c,handleOrgSearchChange:k})})]},t.userID))})]})}),r.data.length===0?e.jsx("div",{className:"m-14 sm:m-48 text-xl font-thin text-center",children:"No Assigned Admin Found"}):e.jsxs("div",{className:"grid grid-rows-1 p-5 gap-2",children:[r.data&&r.data.map(t=>e.jsxs(L,{gridcol:"grid grid-cols-1 sm:grid-cols-12",children:[e.jsx("div",{className:" col-span-3 content-center",children:e.jsxs("h1",{className:"md:ml-2 text-center md:text-left font-bold",children:[t.firstname," ",t.lastname]})}),e.jsx("div",{className:"col-span-3 content-center",children:e.jsx("h1",{className:"text-center font-semibold truncate text-gray-500",children:t.email})}),e.jsx("div",{className:"col-span-3 content-center",children:e.jsx("h1",{className:" text-center text-sm font-semibold text-gray-500",children:t.college})}),e.jsx("div",{className:"col-span-2 px-4 text-sm flex items-center justify-center ",children:e.jsx(C,{trigger:e.jsxs("h1",{onClick:()=>{I(t.userID)},className:"px-4 text-center font-semibold rounded-xl poppins bg-green-50 border-2 border-green-600 text-green-800",children:["Joined"," ",t.organizations_count," ",t.organizations_count>1?"Organizations":"Organization"]}),title:`Assigned Organizations for ${t.firstname} ${t.lastname}`,children:v.length!==0?e.jsx("div",{className:"grid sm:grid-cols-2 overflow-auto grid-cols-1 gap-4 p-5",children:v.map(s=>e.jsx(E,{isDeleting:!0,userRoles:S,organization:s,onClick:()=>{},selectedOrg:N,onDelete:H},s.orgID))}):e.jsx("div",{className:"m-14 sm:m-48 text-xl font-thin text-center",children:"No Organization Found"})})}),e.jsx(R,{title:"Assign Role for Student",description:e.jsxs("div",{children:["Asssign"," ",e.jsxs("span",{className:"font-bold",children:[t.firstname," ",t.lastname," "]}),"to what organization?"]}),trigger:e.jsx("div",{onClick:()=>{I(t.userID)},className:"flex items-center  justify-center",children:e.jsx("div",{className:"hover:bg-gray-300 rounded-full p-2",children:e.jsx(j,{})})}),handleInvite:U,filteredOrganizations:p,currentUserRoles:S,selectedOrg:N,processing:O,getOrg:z,orgSearchQuery:c,handleOrgSearchChange:k})]},t.userID)),e.jsx("div",{className:"fixed w-screen bottom-0 left-0 right-0 pl-8 sm:pl-24 pr-10 pb-3 flex justify-center",children:e.jsx(oe,{page:r})})]})]})})})]})}export{Re as default};
