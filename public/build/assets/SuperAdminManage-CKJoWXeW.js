import{j as e,r,y as g,W as H,Y as P}from"./app-h74hxgxF.js";import{S as F}from"./SuperAdminLayout-BSMCcILO.js";import{I as B}from"./IconInvite-Bps36WTT.js";import{I as W}from"./IconCheckBox-Dl_MkaNL.js";import{M as $}from"./MainAdminFrame-Dsx2fAMZ.js";import{I as T}from"./IconEdit-gibsJMdo.js";import{S as Q,A as v}from"./Searchbar-0QI3vuNb.js";import{I as R}from"./IconEye-BG44WCGR.js";import{D as _,a as q,b as U,c as Y,d as G,g as J}from"./dropdown-menu-DFKDhmpk.js";import{D as K,b as X,c as Z,d as z,e as ee}from"./index-D9pfCYo-.js";import"./alert-dialog-gjy1flUZ.js";import{H as te}from"./Home-Co6cPG9m.js";import{I as se}from"./OrganizationLayout-RXhY8TdK.js";import"./switch-Bgt8sb0r.js";import{C as le}from"./CustomPagination-QzJAiH0g.js";import{S as ae,a as re,b as ne,c as ie,d as y}from"./select-ChEicl5R.js";import"./IconMenu3-BzCiLpbz.js";import"./utils-Bk34F7LL.js";import"./index-J_LSmaUG.js";import"./button-B7Do0KW0.js";import"./IconSearch-DkT2ytbD.js";import"./index-dUStgT57.js";import"./index-CLqQc1E7.js";import"./IconMailFilled-fZ_3mu4k.js";import"./UserLayout-ByTKwmr2.js";import"./IconProfile-BH_CLqXe.js";import"./index-DjgU4tLt.js";import"./index-BR6b7Q5s.js";function ce({size:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s||"24",height:s||"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon icon-tabler icons-tabler-outline icon-tabler-users",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"}),e.jsx("path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),e.jsx("path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85"})]})}function oe({size:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s||"24",height:s||"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon icon-tabler icons-tabler-outline icon-tabler-bolt",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11"})]})}function de({size:s,className:n}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s||"24",height:s||"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`icon icon-tabler icons-tabler-outline icon-tabler-chevron-down ${n}`,children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M6 9l6 6l6 -6"})]})}function me({size:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s||"24",height:s||"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon icon-tabler icons-tabler-outline icon-tabler-device-floppy",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"}),e.jsx("path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),e.jsx("path",{d:"M14 4l0 4l-6 0l0 -4"})]})}function he({size:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:s||"24",height:s||"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon icon-tabler icons-tabler-outline icon-tabler-cancel",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),e.jsx("path",{d:"M18.364 5.636l-12.728 12.728"})]})}function xe({onSelect:s,...n}){return e.jsxs(_,{children:[e.jsx(q,{className:"w-full",children:n.triggerContent}),e.jsxs(U,{className:"bg-[#f8f8f8] border-gray-300 flex flex-col justify-center space-y-2 p-2",children:[e.jsx(Y,{className:"poppins",children:n.title}),e.jsx(G,{className:"bg-gray-300 mx-2"}),n.dropdownItems.map((m,a)=>e.jsx(J,{onSelect:()=>s(m.value),className:"poppins",children:m.name},a))]})]})}function ue({edit:s,visible:n,setVisible:m,organization:a,onEdit:D,onDelete:o}){r.useRef(null);const u=n?"bg-green-50  border-green-600 text-green-800":"bg-red-50  border-red-600 text-red-800";r.useState({name:a.name,department:a.department});const[d,f]=r.useState(!1),[h,p]=r.useState(null);return r.useEffect(()=>{(async()=>{if(!d)p(null);else try{const x=await axios.get(route("superadmin.fetchOrgData",a.orgID));p(x.data)}catch{p(!1)}})()},[d]),e.jsxs("div",{className:"hover:scale-[1.02] transition-all duration-300 ease-in-out px-4 rounded-xl divide-y divide-gray-300 shadow-lg bg-white hover:bg-gray-100 transOptimize",children:[e.jsxs("div",{className:"py-4 ",children:[e.jsxs("div",{className:"grid grid-cols-6  ",children:[e.jsx("div",{className:"p-2 col-span-2 content-center",children:e.jsx("img",{className:"rounded-full",src:`/storage/logo/${a.logo}`,alt:"Organization Logo",onError:c=>{c.target.onerror=null,c.target.src="https://placehold.co/500x500"}})}),e.jsx("div",{className:"col-span-3  px-2",children:e.jsx("h1",{className:"text-sm font-bold py-4 ",children:a.name})})]}),e.jsx("h3",{className:"text-gray-500 text-xs pt-4 text-justify font-semibold",children:a.department})]}),e.jsxs("div",{className:"grid grid-rows-1 py-4",children:[e.jsxs("div",{className:"grid grid-cols-6 py-1",children:[e.jsx("div",{className:"col-start-1 col-end-2 flex justify-center",children:e.jsx(ce,{})}),e.jsx("div",{className:"text-sm font-semibold col-start-2 col-end-4 content-center",children:"Members:"}),e.jsx("div",{className:"text-sm font-semibold col-start-4 col-end-7 flex justify-center",children:a.members_count!==void 0?a.members_count:"Members not set"})]}),e.jsxs("div",{className:"grid grid-cols-6 py-1 ",children:[e.jsx("div",{className:"col-start-1 col-end-2 flex justify-center ",children:e.jsx(R,{})}),e.jsx("div",{className:"text-sm font-semibold col-start-2 col-end-4 content-center",children:e.jsx("span",{children:"Visibility:"})}),s?e.jsx("div",{className:`text-sm font-semibold col-start-4 col-end-7 flex justify-center rounded-xl border-2 ${u}`,children:e.jsx(xe,{triggerContent:e.jsxs("div",{className:"pl-1 flex items-center justify-center poppins",children:[n?"Visible":"Not Visible",e.jsx(de,{size:"15"})]}),title:"Select visibility",dropdownItems:[{name:"Visible",value:!0},{name:"Not Visible",value:!1}],onSelect:m})}):e.jsx("div",{className:`text-sm font-semibold col-start-4 col-end-7 flex justify-center rounded-xl border-2 ${u}`,children:e.jsx("div",{className:"pl-1 flex content-center poppins",children:n?"Visible":"Not Visible"})})]}),e.jsxs("div",{className:"grid grid-cols-6 py-1 ",children:[e.jsx("div",{className:"col-start-1 col-end-2 flex justify-center",children:e.jsx(oe,{})}),e.jsx("div",{className:"text-sm font-semibold col-start-2 col-end-4 content-center",children:"Status:"}),e.jsx("div",{className:`text-sm font-semibold col-start-4 col-end-7 flex justify-center rounded-xl poppins border-2 ${u}`,children:n?"Active":"Inactive"})]}),e.jsx("div",{className:`pb-1 pt-3 w-full flex items-center ${s&&"opacity-50 pointer-events-none"}`,children:e.jsx("button",{className:"border-2 border-slate-600 bg-slate-200 hover:bg-slate-300 text-sm font-semibold w-full rounded-full py-1",onClick:()=>f(c=>!c),children:"Preview"})})]}),e.jsx(j,{})]});function j(){return e.jsx(K,{open:d,onOpenChange:c=>{p(null),f(c)},children:e.jsxs(X,{className:"max-h-[90%] md:max-w-[90%] max-w-full overflow-y-auto px-0",children:[e.jsxs(Z,{className:"px-4",children:[e.jsxs(z,{children:['Previewing "',a.name,'" Home page:']}),e.jsx(ee,{})]}),h===null?e.jsx("div",{className:"w-full h-52 flex items-center justify-center",children:e.jsx("div",{className:"w-[40px] flex justify-center",children:e.jsx("div",{className:"dot-flashing"})})}):h===!1?e.jsxs("span",{className:"font-bold text-red-500 flex gap-3",children:[e.jsx(se,{})," Failed to fetch preview data."]}):e.jsx("div",{className:"pointer-events-none w-full overflow-y-auto bg-[#EEEEEE] pb-10",children:e.jsx(te,{pageData:h.pageData,pageLayoutData:h.pageLayoutData,withFollow:h.withFollow,preview:!1})})]})})}}function qe({organizations:s={data:[]},departments:n=[],filters:m={}}){const[a,D]=r.useState((s==null?void 0:s.data)||[]),[o,u]=r.useState(m.search||""),[d,f]=r.useState(m.department||"All"),[h,p]=r.useState(n),[j,c]=r.useState(!1),[x,b]=r.useState(()=>s!=null&&s.data?s.data.reduce((t,l)=>(l!=null&&l.orgID&&(t[l.orgID]=l.visibility),t),{}):{}),[pe,S]=r.useState((s==null?void 0:s.data)||[]);r.useEffect(()=>{(()=>{let l=a;o&&(l=l.filter(i=>{var w,N;return((w=i==null?void 0:i.name)==null?void 0:w.toLowerCase().includes(o.toLowerCase()))||((N=i==null?void 0:i.department)==null?void 0:N.toLowerCase().includes(o.toLowerCase()))})),d!=="All"&&(l=l.filter(i=>(i==null?void 0:i.department)===d)),S(l)})()},[o,d,a]);const I=t=>{u(t.target.value)};r.useEffect(()=>{const t=setTimeout(()=>{g.get(route("superadmin.status"),{search:o,department:d},{preserveState:!0,preserveScroll:!0})},300);return()=>clearTimeout(t)},[o]);const k=t=>{f(t),g.get(route("superadmin.status"),{search:o,department:t},{preserveState:!0,preserveScroll:!0})},{data:fe,setData:C,post:M,processing:E,reset:L}=H({organizations:a.map(t=>({id:t==null?void 0:t.orgID,visibility:t==null?void 0:t.visibility}))});r.useEffect(()=>{C("organizations",a.map(t=>({id:t==null?void 0:t.orgID,visibility:x[t==null?void 0:t.orgID]})))},[x]);const A=()=>{c(t=>!t)},O=()=>{M(route("superadmin.update-organizations"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{c(!1),s!=null&&s.data&&s.data.forEach(t=>{t!=null&&t.orgID&&(t.visibility=x[t.orgID])})},onError:()=>{console.error("Save failed. Please try again.")}})},V=()=>{s!=null&&s.data&&b(s.data.reduce((t,l)=>(l!=null&&l.orgID&&(t[l.orgID]=l.visibility),t),{})),c(!1),L()};return e.jsxs("div",{className:"w-full",children:[e.jsx(P,{title:"OSA Dashboard"}),e.jsx(F,{children:e.jsx($,{navItems:[{icon:e.jsx(W,{}),label:"Status",link:"superadmin.status"},{icon:e.jsx(B,{}),label:"Invite",link:"superadmin.invite"}],title:"Manage Organizations",searchbar:e.jsx(Q,{className:"col-span-3",value:o,onChange:I,placeholder:"Search for an organization"}),filter:e.jsx("div",{className:"text-xs col-span-2 shadow-lg flex justify-center rounded-r-xl bg-white text-black",children:e.jsxs(ae,{value:d,onValueChange:k,children:[e.jsx(re,{className:"w-full h-12 border-white bg-transparent",children:e.jsx(ne,{placeholder:"All"})}),e.jsxs(ie,{className:"border-gray-500 bg-[#EEEEEE] quicksand",ref:t=>{t&&(t.ontouchstart=l=>l.preventDefault())},children:[e.jsx(y,{value:"All",className:"hover:!bg-gray-3 hover:!text-white focus:!bg-gray-800 focus:!text-white h-10",children:"All"}),h.map((t,l)=>e.jsx(y,{value:t,className:"hover:!bg-gray-800 hover:!text-white focus:!bg-gray-800 focus:!text-white h-10",children:t},l))]})]})}),children:e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex justify-end me-5 mt-5",children:j?e.jsxs("div",{className:"flex",children:[e.jsx(v,{className:"mr-2 bg-green-100 hover:text-white hover:bg-green-800",onClick:O,icon:e.jsx(me,{}),name:"Save",disabled:E}),e.jsx(v,{className:"mr-2 bg-red-100 hover:text-white hover:bg-red-800",onClick:V,icon:e.jsx(he,{}),name:"Cancel"})]}):e.jsx("div",{className:"flex",children:e.jsx(v,{className:"bg-white hover:bg-gray-800 hover:text-white",onClick:A,icon:e.jsx(T,{}),name:"Edit"})})}),!(s!=null&&s.data)||s.data.length===0?e.jsx("div",{className:"m-14 sm:m-48 text-xl font-thin text-center",children:"No Organizations Found"}):e.jsxs("div",{className:"grid lg:grid-cols-4 sm:grid-cols-2 grid-cols-1 gap-4 p-5 pb-20",children:[s.data.map(t=>e.jsx(ue,{edit:j,visible:x[t.orgID],setVisible:l=>{b(i=>({...i,[t.orgID]:l}))},organization:t},t.orgID)),e.jsx("div",{className:"fixed w-screen bottom-0 left-0 right-0 pl-8 sm:pl-24 pr-10 pb-3 flex justify-center",children:e.jsx(le,{page:s})})]})]})})})]})}export{qe as default};
